a# local ancestry calling

0) Before starting:
Call variant sites (variant_sites/)
Get genomewide ancestry prior for each pop from NGSAdmix (global_ancestry/)
Calculate allele frequencies & # included individuals for allopatric maize and mex (within_ancestry_diversity/)

1) Filter SNPs for 'informative' sites with > .3 alelle freq diff between allopatric maize and mexicana and minimum 10 individuals with data from each group
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE,D=0.3,MIN_MAIZE=10,MIN_MEX=10 filterAlloMAFnInd.sh
Submitted batch job 10490296 - redoing:
Submitted batch job 10490726 - RUNNING

2) Reduce LD by filter SNPs to minimum >.001 cM spacing
local_ancestry$ sbatch --dependency=afterok:10490726 pruneFixedcM_HMM.sh
Submitted batch job 10491135 - DIDN;T WORK - FORGOT PREFIX 4.26.19:
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE pruneFixedcM_HMM.sh
Submitted batch job 10495041

3a) Get allele counts for allopatric maize
# making VCF for allopatric maize
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE --dependency=afterok:10495041 getVCFforAllo.sh
Submitted batch job 10495391 - FAILED 4.26.19. fix typo:
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE getVCFforAllo.sh
Submitted batch job 10496067 - RUNNING 4.27.19


# turning VCF into an allele counts file
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE --dependency=afterok:10495391 alloVCF2AlleleCounts.sh
Submitted batch job 10495392 - DEPENDENCY NOT MET 4.26.19. RETRY:
local_ancestry$ sbatch --export=PREFIX=pass2_alloMAIZE --dependency=afterok:10496067 alloVCF2AlleleCounts.sh
Submitted batch job 10496078 - WAITING 4 DEPENDENCY 4.27.19

3b) Get read counts for all hilo individuals
ACGT counts:
local_ancestry$ sbatch --array=0-217 --export="CHR=1,PREFIX=pass2_alloMAIZE,ALL" countReadsACGT.sh
Major Minor allele counts:
local_ancestry$ sbatch --dependency=afterok:$(echo {**..**} | tr " " ",") --array=0-217 --export=PREFIX=pass2_alloMAIZE countReadsMajorMinor.sh

3c) Sample one read per allopatric mexicana as an 'allele' count & put together with allopatric maize allele counts
makeAlloCountsAncHMMInput.sh

4a) Get lists of included individuals per sympatric pop meeting some minimum coverage threshold, e.g. >.1x mean.

4b) Make input files; including global ancestry per pop. Only include sympatric individuals > threshold coverage
makeAncHMMInput.sh

5) Run ancestry_hmm for each population. Set priors for non admixed populations very low, e.g. .001 admixture
runAncHMM.sh
runAncHMM_noboot.sh

6) Test robustness by filtering counts down to a lower different x coverage
