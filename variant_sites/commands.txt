After read mapping, we use the whole sample (reference and admixed individuals) to identify variant sites using ANGSD.
# PASS1 ANALYSIS LOG:
1) Identified sites with >5% MAF in global sample based on reads meeting mapping and base quality cutoffs.
Filters out sites with too high coverage in global sample and sites with data for too few individuals.
mafs.gz output files from angsd are divided into 5Mb regions across the genome, regions 0-425:
allVarAngsdGL1.sh
(note: high coverage cutoff was based on calculating total depth of coverage (from ANGSD) across some random regions:
R script plot_mapping_metrics.R was used to process the results of calcDepthCovRegions.sh)

2) Created and indexed 'sites' file for each mafs.gz file, listing the chromosome and bp position of each variant site:
mafsToSitesFile.sh

Note: Filtering of individual level data for low or high coverage happens within each analysis.
Different analyses require different filtering from this point for levels of acceptable LD between included SNPs, min. number of individuals with data, and possible enrichment for "ancestry-informativeness" using min. # individuals and allele frequency differencess in allopatric maize and mex reference panels

# UPDATED ANALYSIS:
Call new set of SNPs for combined sample with all hilo individuals plus new allopatric maize (landraces from Li) and old allopatric maize (15 of the 16 lowland mex maize individuals).
Goal is to create a PCA and check that the old and new allopatric maize look fine in PCA space.
hilo_alloMAIZE_MAIZE4LOW_bams.list
# first get mean coverage estimate:
variant_sites$ sbatch --export=PREFIX=hilo_alloMAIZE_MAIZE4LOW,REGIONS_LIST=N1000.L100.regions calcDepthCovRegions.sh
Submitted batch job 9585133 - NOT RUNNING (CHECK ON THIS!). Fixed angsd module in calculating depth per region and waiting for new HILO85 file to be completed:
variant_sites$ sbatch --dependency=afterok:9593488 --export=PREFIX=hilo_alloMAIZE_MAIZE4LOW,REGIONS_LIST=N1000.L100.regions calcDepthCovRegions.sh
Submitted batch job 9593538 - ERROR 3.6.19. Fixed typo in bam path:
Submitted batch job 9593626 - fixed additional bam path issue
Submitted batch job 9593643 - COMPLETED 3.6.19

# TO DO: call variant sites with cutoff based on < 2x mean
# interactively using plot_mapping_metrics.R inferred mean coverage for random regions ~440x
# So I'll use 880 as maximum allowed depth in ANGSD calling variant sites
variant_sites$ sbatch --export=PREFIX=hilo_alloMAIZE_MAIZE4LOW,MAX_DEPTH=880 id_SNPs.sh
Submitted batch job 9612676 - DIDN'T WORK. FIXED TYPO & RERUNNING:
Submitted batch job 9613146 - RUNNING 3.6.19

# TO DO: Call genotypes for tripsacum
